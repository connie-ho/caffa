{"ast":null,"code":"import _slicedToArray from\"/home/kevin/lighthouse/caffa-deploy/caffa/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{React,useContext,useEffect,useState}from\"react\";import Fuse from\"fuse.js\";import{getReviewsForCoffee,avgRatingForCoffee}from\"../../helpers/selectors\";import CoffeeListItem from\"../coffees/CoffeeListItem\";import{stripSearchTerms}from\"./helpers.js\";import DataContext from\"../../contexts/DataContext\";import AddCoffeeButton from\"../add-coffee/AddCoffeeButton\";import{Grid}from\"@material-ui/core\";import Typography from\"@material-ui/core/Typography\";import{makeStyles}from\"@material-ui/core/styles\";import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var useStyles=makeStyles({header:{padding:\"1em\",paddingLeft:\"15px\",fontSize:\"2.5em\"}});export default function SearchList(props){var _useContext=useContext(DataContext),state=_useContext.state;var coffees=Object.values(state.coffees);var reviews=state.reviews;var addCoffee=props.addCoffee,results=props.results;var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),storedUrl=_useState2[0],setStoredURL=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),storedArray=_useState4[0],setStoredArray=_useState4[1];var classes=useStyles();useEffect(function(){setStoredURL(localStorage.getItem(\"url\")||\"\");setStoredArray(localStorage.getItem(\"textarray\")||[]);},[results.url]);var options={isCaseSensitive:false,includeScore:true,shouldSort:true,includeMatches:false,findAllMatches:false,minMatchCharLength:1,location:0,threshold:0.7,distance:100,useExtendedSearch:false,ignoreLocation:false,ignoreFieldNorm:false,keys:[\"name\",\"brand\"]};var fuse=new Fuse(coffees,options);var searchResult=function searchResult(){var searchTerm=\"\";if(storedArray){searchTerm=storedArray.toString();}if(searchTerm!==\"error\"){var string=stripSearchTerms(searchTerm);var Results=fuse.search(string,{limit:5});if(Results.length!==0){return Results.map(function(coffee){var coffeeReviews=getReviewsForCoffee(Object.values(reviews),coffee.item.id);var avgRating=avgRatingForCoffee(coffeeReviews);return/*#__PURE__*/_jsx(Grid,{item:true,xs:12,sm:4,lg:3,children:/*#__PURE__*/_jsx(CoffeeListItem,{coffee:coffee.item,avgRating:avgRating},coffee.item.id)});});}return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(Grid,{item:true,xs:12,children:/*#__PURE__*/_jsx(Typography,{variant:\"body2\",style:{fontSize:\"2em\",padding:\"0.5em\"},children:\"There were no matches!\"})})});}return/*#__PURE__*/_jsx(Grid,{item:true,xs:12,children:/*#__PURE__*/_jsx(Typography,{variant:\"body2\",style:{fontSize:\"2em\"},children:\"There was an error in image search. Your image may not have been detected as a coffee bean bag.\"})});};return/*#__PURE__*/_jsxs(Grid,{container:true,direction:\"row\",children:[/*#__PURE__*/_jsx(Grid,{item:true,xs:false,sm:1}),/*#__PURE__*/_jsxs(Grid,{item:true,xs:12,sm:10,children:[/*#__PURE__*/_jsx(Typography,{variant:\"h2\",className:classes.header,children:\"Your search results\"}),/*#__PURE__*/_jsx(Grid,{container:true,spacing:\"5\",children:searchResult()}),/*#__PURE__*/_jsx(\"br\",{}),storedUrl&&/*#__PURE__*/_jsx(AddCoffeeButton,{url:storedUrl,addCoffee:addCoffee})]}),/*#__PURE__*/_jsx(Grid,{item:true,xs:false,sm:1})]});}","map":{"version":3,"sources":["/home/kevin/lighthouse/caffa-deploy/caffa/frontend/src/components/image-search/SearchList.js"],"names":["React","useContext","useEffect","useState","Fuse","getReviewsForCoffee","avgRatingForCoffee","CoffeeListItem","stripSearchTerms","DataContext","AddCoffeeButton","Grid","Typography","makeStyles","useStyles","header","padding","paddingLeft","fontSize","SearchList","props","state","coffees","Object","values","reviews","addCoffee","results","storedUrl","setStoredURL","storedArray","setStoredArray","classes","localStorage","getItem","url","options","isCaseSensitive","includeScore","shouldSort","includeMatches","findAllMatches","minMatchCharLength","location","threshold","distance","useExtendedSearch","ignoreLocation","ignoreFieldNorm","keys","fuse","searchResult","searchTerm","toString","string","Results","search","limit","length","map","coffee","coffeeReviews","item","id","avgRating"],"mappings":"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","sourcesContent":["import { React, useContext, useEffect, useState } from \"react\";\nimport Fuse from \"fuse.js\";\nimport {\n  getReviewsForCoffee,\n  avgRatingForCoffee,\n} from \"../../helpers/selectors\";\nimport CoffeeListItem from \"../coffees/CoffeeListItem\";\nimport { stripSearchTerms } from \"./helpers.js\";\nimport DataContext from \"../../contexts/DataContext\";\nimport AddCoffeeButton from \"../add-coffee/AddCoffeeButton\";\nimport { Grid } from \"@material-ui/core\";\nimport Typography from \"@material-ui/core/Typography\";\nimport { makeStyles } from \"@material-ui/core/styles\";\n\nconst useStyles = makeStyles({\n  header: {\n    padding: \"1em\",\n    paddingLeft: \"15px\",\n    fontSize: \"2.5em\",\n  },\n});\n\nexport default function SearchList(props) {\n  const { state } = useContext(DataContext);\n  const coffees = Object.values(state.coffees);\n  const reviews = state.reviews;\n  const { addCoffee, results } = props;\n  const [storedUrl, setStoredURL] = useState(\"\");\n  const [storedArray, setStoredArray] = useState([]);\n  const classes = useStyles();\n\n  useEffect(() => {\n    setStoredURL(localStorage.getItem(\"url\") || \"\");\n    setStoredArray(localStorage.getItem(\"textarray\") || []);\n  }, [results.url]);\n\n  const options = {\n    isCaseSensitive: false,\n    includeScore: true,\n    shouldSort: true,\n    includeMatches: false,\n    findAllMatches: false,\n    minMatchCharLength: 1,\n    location: 0,\n    threshold: 0.7,\n    distance: 100,\n    useExtendedSearch: false,\n    ignoreLocation: false,\n    ignoreFieldNorm: false,\n    keys: [\"name\", \"brand\"],\n  };\n\n  const fuse = new Fuse(coffees, options);\n\n  const searchResult = () => {\n    let searchTerm = \"\";\n    if (storedArray) {\n      searchTerm = storedArray.toString();\n    }\n\n    if (searchTerm !== \"error\") {\n      const string = stripSearchTerms(searchTerm);\n\n      const Results = fuse.search(string, { limit: 5 });\n\n      if (Results.length !== 0) {\n        return Results.map((coffee) => {\n          const coffeeReviews = getReviewsForCoffee(\n            Object.values(reviews),\n            coffee.item.id\n          );\n          const avgRating = avgRatingForCoffee(coffeeReviews);\n          return (\n            <Grid item xs={12} sm={4} lg={3}>\n              <CoffeeListItem\n                key={coffee.item.id}\n                coffee={coffee.item}\n                avgRating={avgRating}\n              />\n            </Grid>\n          );\n        });\n      }\n      return (\n        <>\n          <Grid item xs={12}>\n            <Typography\n              variant=\"body2\"\n              style={{ fontSize: \"2em\", padding: \"0.5em\" }}\n            >\n              There were no matches!\n            </Typography>\n          </Grid>\n        </>\n      );\n    }\n    return (\n      <Grid item xs={12}>\n        <Typography variant=\"body2\" style={{ fontSize: \"2em\" }}>\n          There was an error in image search. Your image may not have been\n          detected as a coffee bean bag.\n        </Typography>\n      </Grid>\n    );\n  };\n\n  return (\n    <Grid container direction=\"row\">\n      <Grid item xs={false} sm={1} />\n      <Grid item xs={12} sm={10}>\n        <Typography variant=\"h2\" className={classes.header}>\n          Your search results\n        </Typography>\n        <Grid container spacing=\"5\">\n          {searchResult()}\n        </Grid>\n        <br></br>\n        {storedUrl && <AddCoffeeButton url={storedUrl} addCoffee={addCoffee} />}\n      </Grid>\n      <Grid item xs={false} sm={1} />\n    </Grid>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}