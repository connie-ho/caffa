{"ast":null,"code":"var _jsxFileName = \"/home/kevin/lighthouse/caffa-deploy/caffa/frontend/src/components/image-search/ImageSearchModal.js\",\n    _s = $RefreshSig$();\n\nimport { React, useState, useEffect, useContext } from \"react\";\nimport Button from \"@material-ui/core/Button\";\nimport Dialog from \"@material-ui/core/Dialog\";\nimport { makeStyles } from \"@material-ui/core\";\nimport DialogActions from \"@material-ui/core/DialogActions\";\nimport DialogContent from \"@material-ui/core/DialogContent\";\nimport Typography from \"@material-ui/core/Typography\";\nimport DialogTitle from \"@material-ui/core/DialogTitle\";\nimport CircularProgress from \"@material-ui/core/CircularProgress\";\nimport UploadForm from \"./UploadForm\";\nimport { projectStorage } from \"../../firebase/config\";\nimport { googleImageDetection } from \"./helpers\";\nimport { useHistory } from \"react-router-dom\";\nimport SearchContext from \"../../contexts/SearchContext\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function FormDialog(props) {\n  _s();\n\n  const {\n    results,\n    setResults\n  } = useContext(SearchContext);\n  const [file, setFile] = useState(null);\n  const [uploadFile, setUploadFile] = useState(null);\n  const [error, setError] = useState(\"\");\n  const [loading, setLoading] = useState(false);\n  const [url, setUrl] = useState(null);\n  const [textArray, setTextArray] = useState([]);\n  const history = useHistory();\n  useEffect(() => {\n    if (uploadFile) {\n      setLoading(true);\n      const storageRef = projectStorage.ref(uploadFile.name);\n      storageRef.put(uploadFile).on(\"state_changed\", snap => {}, err => {\n        setError(err);\n      }, async () => {\n        const url = await storageRef.getDownloadURL();\n        const textArray = await googleImageDetection(url);\n        setUrl(url);\n        setTextArray(textArray);\n        await setResults({\n          url,\n          textArray: textArray\n        });\n        localStorage.setItem(\"url\", url);\n        localStorage.setItem(\"textarray\", textArray);\n        setLoading(false);\n        history.push(\"/search\");\n        setOpen(false);\n      });\n    }\n  }, [uploadFile]);\n  const {\n    open,\n    setOpen\n  } = props;\n\n  const handleClose = () => {\n    setOpen(false);\n  };\n\n  const uploadAndSearch = file => {\n    if (file) {\n      setUploadFile(file);\n    } else {\n      setError(\"File not selected\");\n    }\n  };\n\n  const useStyles = makeStyles({\n    centreAlignDialogActions: {\n      justifyContent: \"center\"\n    },\n    paper: {\n      overflow: \"auto\",\n      maxHeight: \"700px\",\n      height: 450,\n      width: 400,\n      alignItems: \"center\"\n    },\n    content: {\n      overflow: \"auto\",\n      display: \"flex\",\n      flexDirection: \"column\",\n      justifyContent: \"space-between\",\n      height: 300,\n      width: 300,\n      alignItems: \"center\",\n      border: \"1px dotted black\"\n    },\n    loading: {\n      transform: `translate(0em, 0rem)`\n    },\n    dialogTitle: {\n      root: {\n        fontSize: \"2em\"\n      }\n    }\n  });\n  const classes = useStyles();\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: /*#__PURE__*/_jsxDEV(Dialog, {\n      classes: {\n        paper: classes.paper\n      },\n      open: open,\n      onClose: handleClose,\n      \"aria-labelledby\": \"form-dialog-title\",\n      children: [/*#__PURE__*/_jsxDEV(DialogTitle, {\n        id: \"form-dialog-title\",\n        children: /*#__PURE__*/_jsxDEV(Typography, {\n          variant: \"h6\",\n          style: {\n            fontSize: \"1.5em\"\n          },\n          children: [\" \", \"Image Search\", \" \"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 116,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 115,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(DialogContent, {\n        className: classes.content,\n        children: [/*#__PURE__*/_jsxDEV(UploadForm, {\n          file: file,\n          setFile: setFile,\n          error: error,\n          setError: setError,\n          loading: loading\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 122,\n          columnNumber: 11\n        }, this), loading && /*#__PURE__*/_jsxDEV(CircularProgress, {\n          color: \"primary\",\n          style: {\n            position: \"center\"\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 130,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 121,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(DialogActions, {\n        classes: {\n          root: classes.centreAlignDialogActions\n        },\n        children: [/*#__PURE__*/_jsxDEV(Button, {\n          variant: \"outlined\",\n          onClick: handleClose,\n          style: {\n            fontSize: \"1.0em\",\n            margin: \"0.5rem\"\n          },\n          color: \"primary\",\n          children: \"Cancel\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 135,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Button, {\n          variant: \"outlined\",\n          onClick: () => {\n            uploadAndSearch(file);\n          },\n          style: {\n            fontSize: \"1.0em\",\n            margin: \"0.5rem\"\n          },\n          color: \"primary\",\n          children: \"Search\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 143,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 134,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 109,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 108,\n    columnNumber: 5\n  }, this);\n}\n\n_s(FormDialog, \"cKwGvvOGh7Lg4ePSOAHNxEimrjY=\", true, function () {\n  return [useHistory];\n});\n\n_c = FormDialog;\n\nvar _c;\n\n$RefreshReg$(_c, \"FormDialog\");","map":{"version":3,"sources":["/home/kevin/lighthouse/caffa-deploy/caffa/frontend/src/components/image-search/ImageSearchModal.js"],"names":["React","useState","useEffect","useContext","Button","Dialog","makeStyles","DialogActions","DialogContent","Typography","DialogTitle","CircularProgress","UploadForm","projectStorage","googleImageDetection","useHistory","SearchContext","FormDialog","props","results","setResults","file","setFile","uploadFile","setUploadFile","error","setError","loading","setLoading","url","setUrl","textArray","setTextArray","history","storageRef","ref","name","put","on","snap","err","getDownloadURL","localStorage","setItem","push","setOpen","open","handleClose","uploadAndSearch","useStyles","centreAlignDialogActions","justifyContent","paper","overflow","maxHeight","height","width","alignItems","content","display","flexDirection","border","transform","dialogTitle","root","fontSize","classes","position","margin"],"mappings":"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","sourcesContent":["import { React, useState, useEffect, useContext } from \"react\";\nimport Button from \"@material-ui/core/Button\";\nimport Dialog from \"@material-ui/core/Dialog\";\nimport { makeStyles } from \"@material-ui/core\";\nimport DialogActions from \"@material-ui/core/DialogActions\";\nimport DialogContent from \"@material-ui/core/DialogContent\";\nimport Typography from \"@material-ui/core/Typography\";\nimport DialogTitle from \"@material-ui/core/DialogTitle\";\nimport CircularProgress from \"@material-ui/core/CircularProgress\";\nimport UploadForm from \"./UploadForm\";\nimport { projectStorage } from \"../../firebase/config\";\nimport { googleImageDetection } from \"./helpers\";\nimport { useHistory } from \"react-router-dom\";\nimport SearchContext from \"../../contexts/SearchContext\";\n\nexport default function FormDialog(props) {\n  const { results, setResults } = useContext(SearchContext);\n  const [file, setFile] = useState(null);\n  const [uploadFile, setUploadFile] = useState(null);\n  const [error, setError] = useState(\"\");\n  const [loading, setLoading] = useState(false);\n  const [url, setUrl] = useState(null);\n  const [textArray, setTextArray] = useState([]);\n  const history = useHistory();\n\n  useEffect(() => {\n    if (uploadFile) {\n      setLoading(true);\n\n      const storageRef = projectStorage.ref(uploadFile.name);\n      storageRef.put(uploadFile).on(\n        \"state_changed\",\n        (snap) => {},\n        (err) => {\n          setError(err);\n        },\n        async () => {\n          const url = await storageRef.getDownloadURL();\n          const textArray = await googleImageDetection(url);\n\n          setUrl(url);\n          setTextArray(textArray);\n\n          await setResults({\n            url,\n            textArray: textArray,\n          });\n\n          localStorage.setItem(\"url\", url);\n          localStorage.setItem(\"textarray\", textArray);\n\n          setLoading(false);\n          history.push(\"/search\");\n          setOpen(false);\n        }\n      );\n    }\n  }, [uploadFile]);\n\n  const { open, setOpen } = props;\n\n  const handleClose = () => {\n    setOpen(false);\n  };\n\n  const uploadAndSearch = (file) => {\n    if (file) {\n      setUploadFile(file);\n    } else {\n      setError(\"File not selected\");\n    }\n  };\n\n  const useStyles = makeStyles({\n    centreAlignDialogActions: {\n      justifyContent: \"center\",\n    },\n    paper: {\n      overflow: \"auto\",\n      maxHeight: \"700px\",\n      height: 450,\n      width: 400,\n      alignItems: \"center\",\n    },\n    content: {\n      overflow: \"auto\",\n      display: \"flex\",\n      flexDirection: \"column\",\n      justifyContent: \"space-between\",\n      height: 300,\n      width: 300,\n      alignItems: \"center\",\n      border: \"1px dotted black\",\n    },\n    loading: {\n      transform: `translate(0em, 0rem)`,\n    },\n    dialogTitle: {\n      root: {\n        fontSize: \"2em\",\n      },\n    },\n  });\n\n  const classes = useStyles();\n\n  return (\n    <div>\n      <Dialog\n        classes={{ paper: classes.paper }}\n        open={open}\n        onClose={handleClose}\n        aria-labelledby=\"form-dialog-title\"\n      >\n        <DialogTitle id=\"form-dialog-title\">\n          <Typography variant=\"h6\" style={{ fontSize: \"1.5em\" }}>\n            {\" \"}\n            Image Search{\" \"}\n          </Typography>\n        </DialogTitle>\n        <DialogContent className={classes.content}>\n          <UploadForm\n            file={file}\n            setFile={setFile}\n            error={error}\n            setError={setError}\n            loading={loading}\n          />\n          {loading && (\n            <CircularProgress color=\"primary\" style={{ position: \"center\" }} />\n          )}\n        </DialogContent>\n\n        <DialogActions classes={{ root: classes.centreAlignDialogActions }}>\n          <Button\n            variant=\"outlined\"\n            onClick={handleClose}\n            style={{ fontSize: \"1.0em\", margin: \"0.5rem\" }}\n            color=\"primary\"\n          >\n            Cancel\n          </Button>\n          <Button\n            variant=\"outlined\"\n            onClick={() => {\n              uploadAndSearch(file);\n            }}\n            style={{ fontSize: \"1.0em\", margin: \"0.5rem\" }}\n            color=\"primary\"\n          >\n            Search\n          </Button>\n        </DialogActions>\n      </Dialog>\n    </div>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}